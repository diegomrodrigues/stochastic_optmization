## Relações de Dominância Estocástica em Otimização Probabilística

### Introdução

No âmbito da otimização estocástica, particularmente em problemas envolvendo restrições probabilísticas, a comparação entre variáveis aleatórias torna-se fundamental. Frequentemente, a simples comparação de valores esperados não é suficiente para capturar adequadamente as preferências em relação ao risco ou para garantir a confiabilidade de um sistema sob incerteza [^1]. Em tais cenários, as **relações de dominância estocástica** oferecem uma ferramenta mais robusta para ordenar variáveis aleatórias com base em suas distribuições de probabilidade. Este capítulo foca na definição e caracterização dessas relações, explorando a dominância de primeira e ordens superiores, com base nas desigualdades específicas satisfeitas por suas funções de distribuição cumulativa (CDFs) ou transformações destas. Como veremos, estas relações estão intrinsecamente ligadas a classes específicas de restrições probabilísticas, incluindo as restrições de Value-at-Risk (VaR) e Average Value-at-Risk (AV@R), e a problemas de otimização semi-infinitos [^4, ^7, ^14, ^16, ^23]. O entendimento dessas relações é crucial para a análise e formulação de modelos de otimização sob incerteza que reflitam atitudes mais complexas em relação ao risco.

### Conceitos Fundamentais

#### Dominância Estocástica de Primeira Ordem

A forma mais básica de comparação estocástica é a dominância de primeira ordem.

> **Definição 4.3.** Uma variável aleatória $X$ domina em primeira ordem uma variável aleatória $Y$ (denotado $X \\ge_{(1)} Y$) se suas funções de distribuição cumulativa, $F_X$ e $F_Y$, satisfazem a seguinte desigualdade para todo $\\eta \\in \\mathbb{R}$:\n> $$ F_X(\\eta) \\le F_Y(\\eta) \\quad \\forall \\eta \\in \\mathbb{R} $$\n> [^4].

Esta condição significa que a probabilidade de $X$ assumir um valor menor ou igual a $\\eta$ é sempre menor ou igual à probabilidade correspondente para $Y$. Intuitivamente, $X$ tende a assumir valores maiores que $Y$.

Uma caracterização alternativa da dominância de primeira ordem pode ser dada em termos das funções de distribuição inversas. A **inversa à esquerda contínua** da função de distribuição cumulativa $F_X$ é definida como:\n$$ F_X^{(-1)}(p) = \\inf \\{\\eta : F_X(\\eta) \\ge p\\}, \\quad p \\in (0, 1) $$\n[^5]. O valor $F_X^{(-1)}(p)$ representa o $p$-quantil esquerdo da variável aleatória $X$. Diretamente da definição de dominância de primeira ordem, temos a seguinte equivalência:\n$$ X \\ge_{(1)} Y \\iff F_X^{(-1)}(p) \\ge F_Y^{(-1)}(p), \\quad \\forall p \\in (0, 1) $$\n[^6].

A restrição de dominância de primeira ordem pode ser interpretada como um contínuo de restrições probabilísticas (ou de chance) [^7]. Por exemplo, no contexto de seleção de portfólios (Exemplo 4.5), exigir que o retorno do investimento $\\sum R_i x_i$ domine um benchmark $Y$ em primeira ordem é equivalente a satisfazer a restrição de Value-at-Risk para um contínuo de níveis de probabilidade $p_\\eta = \\Pr\\{Y \\le \\eta\\}$ [^16]:\n$$ \\Pr\\left\\{\\sum_{i=1}^n R_i x_i \\le \\eta\\right\\} \\le p_\\eta, \\quad \\forall \\eta \\in \\mathbb{R} $$\nEsta relação é fundamental em problemas de otimização semi-infinitos com restrições de ordenação estocástica, como o problema (4.9) onde se exige $\\Pr\\{g(x, Z) \\le \\eta\\} \\le F_Y(\\eta)$ para $\\eta$ em um intervalo $[a, b]$ [^14, ^23]. A análise de tais problemas frequentemente envolve condições de otimalidade que utilizam funcionais duais, como medidas ou funções de utilidade, associadas a essas restrições contínuas [^24, ^25, ^26].

#### Dominância Estocástica de Ordens Superiores

A noção de dominância estocástica pode ser generalizada para ordens $k \\ge 2$. Para isso, definimos as **funções de distribuição de ordem superior** para uma variável aleatória $X \\in L_{k-1}(\\Omega, \\mathcal{F}, P)$. Denotando $F_X^{(1)}(\\eta) = F_X(\\eta)$, definimos recursivamente:\n$$ F_X^{(k)}(\\eta) = \\int_{-\\infty}^\\eta F_X^{(k-1)}(t) dt \\quad \\text{para } k = 2, 3, 4, \\dots $$\n[^8]. A função $F_X^{(2)}(\\eta)$ é conhecida como a **função de distribuição integrada** e possui uma interpretação importante. Integrando por partes, obtemos a seguinte fórmula [^9]:\n$$ F_X^{(2)}(\\eta) = \\int_{-\\infty}^\\eta F_X(a) da = E[(\\eta - X)_+] $$\nonde $[a]_+ = \\max\\{a, 0\\}$. Este valor representa a **expected shortfall** de $X$ em relação ao limiar $\\eta$. A função $F_X^{(2)}(\\cdot)$ é bem definida e finita para qualquer variável aleatória integrável, sendo contínua, não-negativa, não-decrescente e convexa [^10]. Por argumentos similares, as funções de distribuição de ordem superior $F_X^{(k)}(\\cdot)$ para $k > 2$ são contínuas, não-negativas, não-decrescentes e convexas [^11].

Com base nessas funções, definimos a dominância estocástica de ordem superior.

> **Definição 4.4.** Dadas duas variáveis aleatórias $X$ e $Y$ em $L_{k-1}(\\Omega, \\mathcal{F}, P)$, dizemos que $X$ domina $Y$ na $k$-ésima ordem (denotado $X \\ge_{(k)} Y$) se:\n> $$ F_X^{(k)}(\\eta) \\le F_Y^{(k)}(\\eta), \\quad \\forall \\eta \\in \\mathbb{R} $$\n> [^13].

Para $k=2$, a **dominância estocástica de segunda ordem** ($X \\ge_{(2)} Y$) pode ser expressa de forma equivalente usando a expected shortfall, devido a (4.7) [^12, ^18]:\n$$ X \\ge_{(2)} Y \\iff E{[(\\eta - X)_+]} \\le E{[(\\eta - Y)_+]}, \\quad \\forall \\eta \\in \\mathbb{R} $$\n[^12]. Esta relação é fundamental para tomadores de decisão avessos ao risco que possuem funções de utilidade côncavas.

A restrição de dominância estocástica de segunda ordem também pode ser vista como um contínuo de restrições sobre a **Average Value-at-Risk (AV@R)** (também chamada Conditional Value-at-Risk) [^19]. Para mais detalhes sobre essa conexão, Dentcheva e Ruszczyński [56] podem ser consultados [^19]. Em problemas de otimização, como na seleção de portfólios (4.12), impor $X \\ge_{(k)} Y$ pode ser uma alternativa à dominância de primeira ordem ou a restrições simples de VaR [^17]. Se a restrição de dominância (4.10) for considerada apenas para um ponto $\\eta=a=b$, ela se reduz a uma única restrição sobre a shortfall $E[(a - g(x, Z))_+]$ [^20].

É importante notar que a dominância de primeira ordem implica a dominância de segunda ordem (e, em geral, $X \\ge_{(k)} Y \\implies X \\ge_{(k+1)} Y$). O conjunto $A_1(Y) = \\{X \\in L_1 : X \\ge_{(1)} Y\\}$ está contido no conjunto $A_2(Y) = \\{X \\in L_1 : X \\ge_{(2)} Y\\}$. Enquanto $A_2(Y)$ é sempre um conjunto convexo e fechado [^21], $A_1(Y)$ não é convexo em geral, como ilustrado no Exemplo 4.49 [p. 111]. Nesse exemplo, com $\\Omega = \\{\\omega_1, \\omega_2\\}$, $P\\{\\omega_1\\} = P\\{\\omega_2\\} = 1/2$, $Y(\\omega_1)=-1$, $Y(\\omega_2)=1$, temos que $X_1=Y$ e $X_2=-Y$ dominam $Y$ em primeira ordem, mas a combinação convexa $X = (X_1+X_2)/2 = 0$ não domina $Y$ em primeira ordem. No entanto, $X=0$ domina $Y$ em segunda ordem.

Para distribuições discretas com probabilidades iguais $1/N$, a dominância estocástica de segunda ordem coincide com o conceito de **weak majorization** [^22]. Especificamente, $X \\ge_{(2)} Y$ se e somente se $\\sum_{k=1}^l x_{[k]} \\ge \\sum_{k=1}^l y_{[k]}$ para $l=1, \\dots, N$, onde $x_{[k]}$ denota a $k$-ésima menor realização de $X$. Isso estabelece uma ligação com a teoria das desigualdades e matrizes duplamente estocásticas [^22].

### Conclusão

As relações de dominância estocástica fornecem um framework rigoroso para comparar variáveis aleatórias em otimização probabilística, indo além da simples comparação de médias. A dominância de primeira ordem, ligada a um contínuo de restrições de VaR, representa uma preferência universal por "mais". A dominância de segunda ordem, equivalente a comparar expected shortfalls ou um contínuo de restrições de AV@R, é crucial para modelar a aversão ao risco. As generalizações para ordens superiores permitem capturar preferências de risco ainda mais refinadas. A definição dessas relações através de desigualdades nas funções de distribuição (ou suas integrais) e suas caracterizações alternativas (via quantis ou expected shortfall) são ferramentas essenciais na formulação e análise de problemas de otimização sob incerteza, especialmente em finanças e gerenciamento de risco, onde a confiabilidade e o controle de perdas são primordiais [^1, ^3, ^16, ^17].

### Referências

[^1]: (Page 87) We emphasize that imposing constraints on probability of events is particularly appropriate whenever high uncertainty is involved and reliability is a central issue. In such cases, constraints on the expected value may not be sufficient to reflect our attitude to undesirable outcomes.\n[^2]: (Page 88) Example 4.1 (Vehicle Routing Problem). ... Min c^T x s.t. Pr{Tx ≥ Z} ≥ p, x ∈ Z_+^n.\n[^3]: (Page 89) Example 4.2 (Portfolio Optimization with Value-at-Risk Constraint). ... Max Σ E[Ri]xi s.t. Pr{Σ Rixi ≥ η} ≥ p.\n[^4]: (Page 90) Definition 4.3. A random variable X dominates in the first order a random variable Y (denoted X ≥(1) Y) if Fx(η) ≤ Fy(η), ∀η ∈ R.\n[^5]: (Page 90) The left-continuous inverse F_X^{(-1)} of the cumulative distribution function of a random variable X is defined as follows: F_X^{(-1)}(p) = inf {η : F(X; η) ≥ p}, p ∈ (0, 1).\n[^6]: (Page 90) Directly from the definition of the first order dominance we see that X ≥(1) Y <=> F_X^{(-1)}(p) ≥ F_Y^{(-1)}(p), ∀p ∈ (0, 1). (4.6)\n[^7]: (Page 90) The first order dominance constraint can be interpreted as a continuum of probabilistic (chance) constraints.\n[^8]: (Page 90) Denoting F_X^{(1)}(η) = Fx(η), we define higher order distribution functions of a random variable X ∈ L_{k-1}(Ω, F, P) as follows: F_X^{(k)}(η) = ∫_{-∞}^η F_X^{(k-1)}(t) dt for k = 2, 3, 4, ....\n[^9]: (Page 91) We can express the integrated distribution function F_X^{(2)} as the expected shortfall function. Integrating by parts, for each value η, we have the following formula: F_X^{(2)}(η) = ∫_{-∞}^η Fx(a) da = E[(η - X)_+]. (4.7)\n[^10]: (Page 91) The function F_X^{(2)}(·) is well defined and finite for every integrable random variable. It is continuous, nonnegative, and nondecreasing. The function F_X^{(2)}(·) is also convex because its derivative is nondecreasing as it is a cumulative distribution function.\n[^11]: (Page 91) By the same arguments, the higher order distribution functions are continuous, nonnegative, nondecreasing, and convex as well.\n[^12]: (Page 91) Due to (4.7), the second order dominance relation can be expressed in an equivalent way as follows: X ≥(2) Y iff E{[η - X]_+} ≤ E{[η - Y]_+}, ∀η ∈ R. (4.8)\n[^13]: (Page 91) Definition 4.4. Given two random variables X and Y in L_{k-1}(Ω, F, P) we say that X dominates Y in the kth order if F_X^{(k)}(η) ≤ F_Y^{(k)}(η), ∀η ∈ R. We denote this relation by X ≥(k) Y.\n[^14]: (Page 91) We call the following semi-infinite (probabilistic) problem a stochastic optimization problem with a stochastic ordering constraint: Min c(x) s.t. Pr{g(x, Z) ≤ η} ≤ Fy(η), η ∈ [a, b], x ∈ X. (4.9)\n[^15]: (Page 91) In general, we formulate the following semi-infinite probabilistic problem, which we refer to as a stochastic optimization problem with a stochastic dominance constraint of order k ≥ 2: Min c(x) s.t. F_{g(x,Z)}^{(k)}(η) ≤ F_Y^{(k)}(η), η ∈ [a, b], x ∈ X. (4.10)\n[^16]: (Page 92) Example 4.5 (Portfolio Selection Problem with Stochastic Ordering Constraints). Returning to Example 4.2, we can require that the net profit on our investment dominates certain benchmark outcome Y... Then the Value-at-Risk constraint has to be satisfied at a continuum of points η ∈ R. Setting Pr{Y ≤ η} = p_η, we formulate the following model: Max Σ E[Ri]xi s.t. Pr{Σ Rixi ≤ η} ≤ p_η, ∀η ∈ R. (4.11)\n[^17]: (Page 92) Using higher order stochastic dominance relations, we formulate a portfolio optimization model of form Max Σ E[Ri]xi s.t. Σ Rixi ≥(k) Y, ... (4.12)\n[^18]: (Page 92) A second order dominance constraint on the portfolio return rate represents a constraint on the shortfall function: Σ Rixi ≥(2) Y <=> E[η - Σ Rixi]_+ ≤ E[(η - Y)_+], ∀η ∈ R.\n[^19]: (Page 92) The second order dominance constraint can also be viewed as a continuum of Average Value-at-Risk (AV@R) constraints. For more information on this connection, see Dentcheva and Ruszczyński [56].\n[^20]: (Page 92) We stress that if a = b, then the semi-infinite model (4.9) reduces to a problem with a single probabilistic constraint, and problem (4.10) for k = 2 becomes a problem with a single shortfall constraint.\n[^21]: (Page 110) Proposition 4.48. For every Y ∈ L_1(Ω, F, P) the set A_2(Y) is convex and closed. Proof. By changing the order of integration in the definition of the second order function F^{(2)}, we obtain F_X^{(2)}(η) = E[(η - X)_+]. (4.23) Therefore, an equivalent representation of the second order stochastic dominance relation is given by the relation E[(η - X)_+] ≤ E[(η - Y)_+], ∀η ∈ R. (4.24) For every η ∈ R the functional X → E[(η - X)_+] is convex and continuous in L_1(Ω, F, P)... Consequently, the set A_2(Y) is convex and closed.\n[^22]: (Page 111) Theorem 4.50. Assume that Ω = {ω_1, ..., ω_N}, F contains all subsets of Ω, and P{ω_k} = 1/N, k = 1, ..., N. If Y : (Ω, F, P) → R is a random variable, then conv(A_1(Y)) = A_2(Y). Proof. ... As the probabilities of all elementary events are equal, the second order stochastic dominance relation coincides with the concept of weak majorization, which is characterized by the following system of inequalities: Σ_{k=1}^l x_[k] ≥ Σ_{k=1}^l y_[k], l = 1, ..., N... As established by Hardy, Littlewood, and Polya [73], weak majorization is equivalent to the existence of a doubly stochastic matrix Π such that x ≥ Πy.\n[^23]: (Page 144) 4.5 Semi-infinite Probabilistic Problems. In this section, we concentrate on the semi-infinite probabilistic problem (4.9). We recall its formulation: Min c(x) s.t. Pr{g(x, Z) ≥ η} ≥ Pr{Y ≥ η}, η ∈ [a, b], x ∈ X.\n[^24]: (Page 145) We introduce the functional L : R^n × U → R associated with problem (4.9): L(x, u) = c(x) + E[u(g(x, Z)) - u(Y)]. We shall see that the functional L plays the role of a Lagrangian of the problem.\n[^25]: (Page 146) Theorem 4.87. Assume that x̄ is an optimal solution of problem (4.9) and that the differential uniform dominance condition is satisfied at the point x̄. Then there exists a function û ∈ U, such that -∇xL(x̄, û) ∈ Nx(x̄), E[û(g(x̄, Z))] = E[û(Y)]. (4.95-4.96)\n[^26]: (Page 147) Theorem 4.88. Under the assumptions of Theorem 4.87 there exist piecewise constant utility function w(·) ∈ U satisfying the necessary optimality conditions (4.95)-(4.96).

<!-- END -->